{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\Desktop\\\\servix-cmms\\\\frontend\\\\src\\\\components\\\\tasks\\\\Tasks.js\",\n  _s = $RefreshSig$();\n// frontend/src/components/tasks/Tasks.js\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Select from 'react-select';\nimport { useAuth } from '../../context/AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Tasks = () => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const [tasks, setTasks] = useState([]);\n  const [technicians, setTechnicians] = useState([]);\n  const [equipmentList, setEquipmentList] = useState([]);\n  const [selectedTech, setSelectedTech] = useState(null);\n  const [selectedEquip, setSelectedEquip] = useState(null);\n  const [taskTitle, setTaskTitle] = useState('');\n\n  // Fetch all tasks\n  useEffect(() => {\n    axios.get('/api/tasks').then(res => setTasks(res.data)).catch(err => console.error('Error fetching tasks:', err));\n  }, []);\n\n  // Fetch technicians (preApproved only)\n  useEffect(() => {\n    axios.get('/api/users?role=Technician&preApproved=true').then(res => {\n      const options = res.data.map(t => ({\n        value: t._id,\n        label: t.name\n      }));\n      setTechnicians(options);\n    }).catch(err => console.error('Error fetching technicians:', err));\n  }, []);\n\n  // Fetch equipment (live search ready)\n  const fetchEquipment = inputValue => {\n    return axios.get(`/api/equipment?search=${inputValue}`).then(res => {\n      return res.data.equipment.map(eq => ({\n        value: eq._id,\n        label: `${eq.name} - ${eq.model} - ${eq.serialNumber}`\n      }));\n    }).catch(err => {\n      console.error('Error fetching equipment:', err);\n      return [];\n    });\n  };\n  const handleAssignTask = () => {\n    if (!selectedTech || !selectedEquip || !taskTitle) {\n      alert('Please fill in all fields');\n      return;\n    }\n    axios.post('/api/tasks', {\n      title: taskTitle,\n      assignedTo: selectedTech.value,\n      equipment: selectedEquip.value\n    }).then(res => {\n      setTasks([...tasks, res.data]);\n      setTaskTitle('');\n      setSelectedTech(null);\n      setSelectedEquip(null);\n    }).catch(err => console.error('Error assigning task:', err));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Task Management\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), ((user === null || user === void 0 ? void 0 : user.role) === 'Admin' || (user === null || user === void 0 ? void 0 : user.role) === 'Engineer') && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"assign-task-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Assign Task\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Task Title\",\n        value: taskTitle,\n        onChange: e => setTaskTitle(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Select, {\n        placeholder: \"Select Technician\",\n        options: technicians,\n        value: selectedTech,\n        onChange: setSelectedTech,\n        isClearable: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Select, {\n        placeholder: \"Search Equipment...\",\n        loadOptions: fetchEquipment,\n        value: selectedEquip,\n        onChange: setSelectedEquip,\n        isClearable: true,\n        isSearchable: true,\n        defaultOptions: true,\n        cacheOptions: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleAssignTask,\n        children: \"Assign Task\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"All Tasks\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: tasks.map(task => {\n        var _task$assignedTo;\n        return /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [task.title, \" \\u2014 Assigned to: \", ((_task$assignedTo = task.assignedTo) === null || _task$assignedTo === void 0 ? void 0 : _task$assignedTo.name) || 'Unassigned']\n        }, task._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 5\n  }, this);\n};\n_s(Tasks, \"s0P2Sm2rrjPEK3ffRrHvOX9Ktds=\", false, function () {\n  return [useAuth];\n});\n_c = Tasks;\nexport default Tasks;\nvar _c;\n$RefreshReg$(_c, \"Tasks\");","map":{"version":3,"names":["React","useState","useEffect","axios","Select","useAuth","jsxDEV","_jsxDEV","Tasks","_s","user","tasks","setTasks","technicians","setTechnicians","equipmentList","setEquipmentList","selectedTech","setSelectedTech","selectedEquip","setSelectedEquip","taskTitle","setTaskTitle","get","then","res","data","catch","err","console","error","options","map","t","value","_id","label","name","fetchEquipment","inputValue","equipment","eq","model","serialNumber","handleAssignTask","alert","post","title","assignedTo","children","fileName","_jsxFileName","lineNumber","columnNumber","role","className","type","placeholder","onChange","e","target","isClearable","loadOptions","isSearchable","defaultOptions","cacheOptions","onClick","task","_task$assignedTo","_c","$RefreshReg$"],"sources":["C:/Users/USER/Desktop/servix-cmms/frontend/src/components/tasks/Tasks.js"],"sourcesContent":["// frontend/src/components/tasks/Tasks.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport Select from 'react-select';\r\nimport { useAuth } from '../../context/AuthContext';\r\n\r\nconst Tasks = () => {\r\n  const { user } = useAuth();\r\n  const [tasks, setTasks] = useState([]);\r\n  const [technicians, setTechnicians] = useState([]);\r\n  const [equipmentList, setEquipmentList] = useState([]);\r\n  const [selectedTech, setSelectedTech] = useState(null);\r\n  const [selectedEquip, setSelectedEquip] = useState(null);\r\n  const [taskTitle, setTaskTitle] = useState('');\r\n\r\n  // Fetch all tasks\r\n  useEffect(() => {\r\n    axios.get('/api/tasks')\r\n      .then(res => setTasks(res.data))\r\n      .catch(err => console.error('Error fetching tasks:', err));\r\n  }, []);\r\n\r\n  // Fetch technicians (preApproved only)\r\n  useEffect(() => {\r\n    axios.get('/api/users?role=Technician&preApproved=true')\r\n      .then(res => {\r\n        const options = res.data.map(t => ({\r\n          value: t._id,\r\n          label: t.name\r\n        }));\r\n        setTechnicians(options);\r\n      })\r\n      .catch(err => console.error('Error fetching technicians:', err));\r\n  }, []);\r\n\r\n  // Fetch equipment (live search ready)\r\n  const fetchEquipment = (inputValue) => {\r\n    return axios.get(`/api/equipment?search=${inputValue}`)\r\n      .then(res => {\r\n        return res.data.equipment.map(eq => ({\r\n          value: eq._id,\r\n          label: `${eq.name} - ${eq.model} - ${eq.serialNumber}`\r\n        }));\r\n      })\r\n      .catch(err => {\r\n        console.error('Error fetching equipment:', err);\r\n        return [];\r\n      });\r\n  };\r\n\r\n  const handleAssignTask = () => {\r\n    if (!selectedTech || !selectedEquip || !taskTitle) {\r\n      alert('Please fill in all fields');\r\n      return;\r\n    }\r\n    axios.post('/api/tasks', {\r\n      title: taskTitle,\r\n      assignedTo: selectedTech.value,\r\n      equipment: selectedEquip.value\r\n    })\r\n      .then(res => {\r\n        setTasks([...tasks, res.data]);\r\n        setTaskTitle('');\r\n        setSelectedTech(null);\r\n        setSelectedEquip(null);\r\n      })\r\n      .catch(err => console.error('Error assigning task:', err));\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>Task Management</h2>\r\n\r\n      {/* Assign Task Section - Only for Admin & Engineer */}\r\n      {(user?.role === 'Admin' || user?.role === 'Engineer') && (\r\n        <div className=\"assign-task-section\">\r\n          <h3>Assign Task</h3>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Task Title\"\r\n            value={taskTitle}\r\n            onChange={(e) => setTaskTitle(e.target.value)}\r\n          />\r\n          <Select\r\n            placeholder=\"Select Technician\"\r\n            options={technicians}\r\n            value={selectedTech}\r\n            onChange={setSelectedTech}\r\n            isClearable\r\n          />\r\n          <Select\r\n            placeholder=\"Search Equipment...\"\r\n            loadOptions={fetchEquipment}\r\n            value={selectedEquip}\r\n            onChange={setSelectedEquip}\r\n            isClearable\r\n            isSearchable\r\n            defaultOptions\r\n            cacheOptions\r\n          />\r\n          <button onClick={handleAssignTask}>Assign Task</button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Task List */}\r\n      <h3>All Tasks</h3>\r\n      <ul>\r\n        {tasks.map(task => (\r\n          <li key={task._id}>\r\n            {task.title} â€” Assigned to: {task.assignedTo?.name || 'Unassigned'}\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Tasks;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}